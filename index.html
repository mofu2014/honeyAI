<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HoneyAI</title>

<style>
:root{
  --honey-main:#f4b400;
  --honey-light:#ffd54f;
  --honey-dark:#c88719;
  --bg-light:#fff8e1;
  --bg-dark:#1c1a16;
  --text-light:#2b2b2b;
  --text-dark:#f5f5f5;
}

/* テーマ */
body.light{
  background:var(--bg-light);
  color:var(--text-light);
}
body.dark{
  background:var(--bg-dark);
  color:var(--text-dark);
}
body{
  margin:0;
  font-family:"Segoe UI",sans-serif;
  transition:0.3s;
  overflow:hidden;
}

/* 六角形背景 */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background-image:
  radial-gradient(circle at 25px 25px, rgba(0,0,0,0.04) 2px, transparent 2px);
  background-size:50px 50px;
  opacity:0.3;
  pointer-events:none;
}

/* ヘッダー */
header{
  padding:15px;
  text-align:center;
  font-size:22px;
  font-weight:600;
  background:linear-gradient(135deg,var(--honey-light),var(--honey-main));
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
}

/* コントロール */
.controls{
  display:flex;
  gap:10px;
  padding:10px;
  justify-content:center;
  flex-wrap:wrap;
}
select{
  padding:8px 14px;
  border-radius:20px;
  border:none;
  background:var(--honey-light);
  font-size:14px;
}

/* チャットエリア */
.chat{
  height:65vh;
  overflow-y:auto;
  padding:20px;
  display:flex;
  flex-direction:column;
  gap:14px;
}

/* バブル */
.message{
  max-width:70%;
  padding:12px 18px;
  border-radius:24px;
  position:relative;
  animation:fadeIn 0.3s ease;
}
.user{
  align-self:flex-end;
  background:#e0e0e0;
}
.ai{
  align-self:flex-start;
  background:linear-gradient(135deg,var(--honey-light),var(--honey-main));
}

/* 入力欄 */
.input-area{
  display:flex;
  padding:15px;
  gap:10px;
}
input{
  flex:1;
  padding:12px;
  border-radius:20px;
  border:1px solid #ccc;
  font-size:15px;
}
button{
  padding:12px 18px;
  border:none;
  border-radius:20px;
  background:var(--honey-main);
  cursor:pointer;
  transition:0.2s;
}
button:hover{
  background:var(--honey-dark);
  transform:translateY(-2px);
}

/* アニメ */
@keyframes fadeIn{
  from{opacity:0;transform:translateY(5px);}
  to{opacity:1;transform:translateY(0);}
}
</style>
</head>
<body class="light">

<header>HoneyAI</header>

<div class="controls">
  <select id="personality">
    <option value="敬語">敬語</option>
    <option value="なれなれしい">なれなれしい</option>
    <option value="敬語×なれなれしい">敬語×なれなれしい</option>
  </select>

  <select id="theme">
    <option value="light">ライト</option>
    <option value="dark">ブラック</option>
    <option value="system">システム</option>
  </select>
</div>

<div class="chat" id="chat"></div>

<div class="input-area">
  <input type="text" id="input" placeholder="メッセージを入力...">
  <button onclick="sendMessage()">送信</button>
</div>

<script>
const chat = document.getElementById("chat");
const input = document.getElementById("input");
const themeSelect = document.getElementById("theme");

/* テーマ切替 */
themeSelect.addEventListener("change",()=>{
  const value = themeSelect.value;
  if(value==="system"){
    const dark = window.matchMedia("(prefers-color-scheme: dark)").matches;
    document.body.className = dark ? "dark" : "light";
  }else{
    document.body.className = value;
  }
});

/* メッセージ追加 */
function addMessage(text,type){
  const div=document.createElement("div");
  div.className="message "+type;
  div.textContent=text;
  chat.appendChild(div);
  chat.scrollTop=chat.scrollHeight;
}

/* 送信 */
async function sendMessage(){
  const text=input.value.trim();
  if(!text) return;

  addMessage(text,"user");
  input.value="";

  const personality=document.getElementById("personality").value;

  const res=await fetch("/api/chat",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      message:text,
      personality:personality
    })
  });

  const data=await res.json();
  addMessage(data.reply,"ai");
}
</script>

</body>
</html>

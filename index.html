<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HoneyAI ğŸ¯</title>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --honey-dark: #8B4513; --honey-gold: #FFC107; --honey-light: #FFF8E1;
            --honey-accent: #FF9800; --sidebar-bg: #FDF5E6;
        }
        body { font-family: 'M PLUS Rounded 1c', sans-serif; background: var(--honey-light); margin: 0; display: flex; height: 100vh; color: var(--honey-dark); overflow: hidden; }
        
        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar { width: 260px; background: var(--sidebar-bg); border-right: 2px solid #FFE082; display: flex; flex-direction: column; padding: 15px; flex-shrink: 0; transition: 0.3s; }
        .new-chat-btn { background: var(--honey-gold); border: none; padding: 12px; border-radius: 20px; font-weight: bold; cursor: pointer; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .history-list { flex-grow: 1; overflow-y: auto; }
        .history-item { padding: 10px; margin-bottom: 8px; border-radius: 10px; cursor: pointer; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 0.85rem; position: relative; }
        .history-item.active { background: #FFE082; font-weight: bold; }
        .delete-btn { position: absolute; right: 5px; top: 50%; transform: translateY(-50%); background: none; border: none; color: #888; cursor: pointer; display: none; }
        .history-item:hover .delete-btn { display: block; }

        /* ãƒ¡ã‚¤ãƒ³ */
        .main-content { flex-grow: 1; display: flex; flex-direction: column; background: white; }
        header { padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; color: var(--honey-accent); font-weight: bold; }
        #chat-box { flex-grow: 1; padding: 20px; overflow-y: auto; background-image: radial-gradient(#FFF8E1 20%, transparent 20%); background-size: 20px 20px; }
        
        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .message { margin-bottom: 20px; display: flex; flex-direction: column; }
        .bubble { max-width: 80%; padding: 12px 16px; border-radius: 18px; line-height: 1.6; font-size: 0.95rem; word-wrap: break-word; }
        .user-msg { align-items: flex-end; }
        .user-msg .bubble { background: var(--honey-accent); color: white; border-bottom-right-radius: 4px; }
        .ai-msg { align-items: flex-start; }
        .ai-msg .bubble { background: var(--honey-light); border: 1px solid #FFE082; border-bottom-left-radius: 4px; }
        .bubble img { width: 100%; border-radius: 10px; margin-top: 10px; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

        /* å…¥åŠ› */
        .input-area { padding: 15px; border-top: 1px solid #eee; display: flex; gap: 10px; }
        input { flex-grow: 1; padding: 12px; border: 2px solid #ddd; border-radius: 25px; outline: none; }
        .send-btn { background: var(--honey-gold); border: none; width: 45px; height: 45px; border-radius: 50%; cursor: pointer; color: white; font-size: 1.2rem; }

        #settings-panel { display: none; position: absolute; top: 60px; right: 20px; background: white; border: 2px solid var(--honey-gold); padding: 15px; border-radius: 10px; z-index: 100; width: 280px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        
        @media (max-width: 600px) { .sidebar { position: absolute; height: 100%; z-index: 1000; transform: translateX(-100%); } .sidebar.open { transform: translateX(0); } }
    </style>
</head>
<body>

    <aside class="sidebar" id="sidebar">
        <button class="new-chat-btn" onclick="startNewChat()">+ æ–°ã—ã„ãƒãƒ£ãƒƒãƒˆ</button>
        <div class="history-list" id="history-list"></div>
    </aside>

    <main class="main-content">
        <header>
            <span onclick="document.getElementById('sidebar').classList.toggle('open')" style="cursor:pointer;">â˜° ğŸ¯ HoneyAI</span>
            <button onclick="toggleSettings()" style="background:none; border:none; font-size:1.2rem; cursor:pointer;">âš™ï¸</button>
        </header>

        <div id="settings-panel">
            <label style="font-size:0.8rem; font-weight:bold;">æ€§æ ¼ãƒ»ç”»åƒç”Ÿæˆãƒ«ãƒ¼ãƒ«</label>
            <textarea id="system-prompt" rows="8" style="width:100%; font-size:0.75rem; margin-top:5px; padding:5px; border:1px solid #ccc; border-radius:5px;">ã‚ãªãŸã¯ãƒãƒãƒŸãƒ„ã®å¦–ç²¾HoneyAIã§ã™ã€‚èªå°¾ã¯ã€Œã€œã ã¿ã¤ã€ã€‚

ã€ç”»åƒç”Ÿæˆã®ãƒ«ãƒ¼ãƒ«ã€‘
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œçµµã‚’æã„ã¦ã€ç­‰ã®ä¾é ¼ã‚’ã—ãŸã‚‰ã€å¿…ãšä»¥ä¸‹ã®Markdownå½¢å¼ã®ã¿ã‚’å‡ºåŠ›ã—ã¦ç”»åƒã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚èª¬æ˜ã¯ä¸è¦ã§ã™ã€‚
![image](https://image.pollinations.ai/prompt/ã€ä¾é ¼å†…å®¹ã‚’è‹±èªã«ã—ãŸè©³ç´°ãªèª¬æ˜ã€‘?width=1024&height=1024&nologo=true&seed=ã€ãƒ©ãƒ³ãƒ€ãƒ ãªæ•°å­—ã€‘)

ç”»åƒç”Ÿæˆä»¥å¤–ã®æ™‚ã¯æ™®é€šã«å„ªã—ãå–‹ã£ã¦ãã ã•ã„ã€‚</textarea>
            <button onclick="toggleSettings()" style="width:100%; margin-top:10px; cursor:pointer;">è¨­å®šã‚’é–‰ã˜ã‚‹</button>
        </div>

        <div id="chat-box"></div>

        <div class="input-area">
            <input type="text" id="user-input" placeholder="ã€ŒçŒ«ã®çµµã‚’æã„ã¦ã€ãªã©..." onkeypress="if(event.key === 'Enter') sendMessage()">
            <button class="send-btn" onclick="sendMessage()">â¤</button>
        </div>
    </main>

    <script>
        let allSessions = JSON.parse(localStorage.getItem('honeyai_sessions')) || {};
        let currentSessionId = null;
        const chatBox = document.getElementById('chat-box');
        const userInput = document.getElementById('user-input');

        window.onload = () => { renderHistoryList(); startNewChat(); };

        function startNewChat() {
            currentSessionId = Date.now().toString();
            allSessions[currentSessionId] = { title: "æ–°ã—ã„ä¼šè©±", messages: [], timestamp: Date.now() };
            chatBox.innerHTML = '<div style="text-align:center; color:#ccc; margin-top:50px;">ğŸ¯ ä½•ã‹ãŠè©±ã—ã—ã¦ã ã¿ã¤ï¼çµµã‚‚æã‘ã‚‹ã‚ˆï¼</div>';
            renderHistoryList();
        }

        function processUserMessage(text) {
            if (allSessions[currentSessionId].messages.length === 0) {
                allSessions[currentSessionId].title = text.substring(0, 15);
                chatBox.innerHTML = ''; 
            }
            appendMessage('user', text);
            allSessions[currentSessionId].messages.push({ role: "user", content: text });
            saveToLocalStorage();
            userInput.value = '';
            renderHistoryList();
        }

        async function sendMessage() {
            const text = userInput.value.trim();
            if (!text) return;
            processUserMessage(text);

            const loadingId = 'L' + Date.now();
            appendMessage('assistant', '<span id="'+loading
